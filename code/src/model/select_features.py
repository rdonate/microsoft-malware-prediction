import numpy as np


def selectFeatures(db,prefix_collections,names_collection, list_features, type_data=None):
    query_project = dict()
    for feature in list_features:
        query_project[feature]=1
    query_project['_id']=0
    query_project['index']=1
    collection = db.selectCollection(prefix_collections + '_' + names_collection)
    length_collection = collection.count()
    # length_collection = 50
    if type_data== None:
        data = np.empty((length_collection, len(list_features)))
        insert_data = insertDataNumbers
    elif type_data== 'str':
        data = list()
        insert_data = insertDataText
    else:
        data = np.empty((length_collection, len(list_features)), dtype=type_data)
        insert_data = insertDataNumbers
    for index in range(length_collection):
        value = collection.find_one({'index':index},projection=query_project)
        for index_feature,feature in enumerate(list_features):
            insert_data(data,index,index_feature,value[feature])
    if type(data)==np.ndarray and data.shape[1]==1 :
        data = np.reshape(data, data.shape[0])
    return data


def insertDataNumbers(data,index,index_feature,value):
    data[index][index_feature] = value

def insertDataText(data,index,index_feature,value):
    data.insert(index,value)
